<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>FriendApp — Setup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="/ui.css">
</head>
<body class="bg">
  <main class="card w-3xl">
    <header class="card-h"><h1>⚙️ Complete your profile</h1></header>
    <section class="grid2">
      <select id="gender" class="in">
        <option value="male">Male</option><option value="female">Female</option>
      </select>
      <input id="language" placeholder="Language (e.g., Telugu)" class="in">
      <input id="location" placeholder="City (optional)" class="in col2">
      <button id="btn_save" class="btn btn-purple col2">Save & Continue</button>
      <div id="status" class="err col2"></div>
    </section>
  </main>
  <script>
    const $=id=>document.getElementById(id);
    const token=localStorage.getItem('fa_token');
    if(!token) location.href='/login.html';
    const api=async(p,b)=>{const r=await fetch(p,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(b)});if(!r.ok)throw new Error((await r.json()).error||'Failed');return r.json();};
    $('btn_save').onclick=async()=>{
      $('status').textContent='';
      try{
        await api('/api/prefs',{token, gender:$('gender').value, language:$('language').value, location:$('location').value});
        location.href='/dashboard.html';
      }catch(e){$('status').textContent=e.message;}
    };
  </script>
</body>
</html>
